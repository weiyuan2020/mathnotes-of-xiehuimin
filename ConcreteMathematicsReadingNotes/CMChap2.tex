\documentclass[mode=geye]{elegantnote}
%!TEX program=xelatex
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{hyperref}
\usepackage{mathtools} % xrightarrow

\newtheorem{exercise}{练习}
\newtheorem{answer}{题目解答}
\newtheorem{solve}{解}

\newcommand{\fallingfactorial}[1]{%
  ^{\underline{#1}}%
}

\newcommand{\risingfactorial}[1]{%
  ^{\overline{#1}}%
}

\title{具体数学阅读笔记-chap2}
\author{weiyuan}
\date{2022-07-04}
\begin{document}
\maketitle
\section{求和}
\subsection{求和符号}
\subsection{求和与递归式 Sums and recurrences}
和式
\begin{equation}
    S_n = \sum_{k=0}^{n}a_k
\end{equation}
等价于递归式
\begin{equation}
    \left\{
        \begin{array}{l}
            S_0 = a_0 \\
            S_n = S_{n-1}+a_n,\quad n>0.
        \end{array}
    \right.
\end{equation}
若$ a_n = const.+ k\cdot n $ , 则有
\begin{equation}\label{ReceEasy}
    \left\{
    \begin{aligned}
        R_0 &= \alpha \\
        R_n &= R_{n-1} + \beta + \gamma n, \quad n>0
    \end{aligned}
    \right.
\end{equation}
\begin{align*}
    R_1 &= R_0 + \beta + \gamma \\
    R_2 &= R_0 + 2\beta + 3\gamma \\
        &\vdots \\
    R_n &= A(n)\alpha + B(n)\beta + C(n)\gamma
\end{align*}
\begin{equation}\label{RecuEasyABC}
    R_n = A(n)\alpha + B(n)\beta + C(n)\gamma
\end{equation}
repertoire method
令$ R_n=1 $ , 则$ \alpha=1, \beta=0, \gamma=0 $ , 
\begin{equation*}
    A(n)=1
\end{equation*}
令$ R_n=n $ , 则$ \alpha=0, \beta=1, \gamma=0 $ , 
\begin{equation*}
    B(n)=n
\end{equation*}
令$ R_n=n^2 $ , 则$ \alpha=0, \beta=-1, \gamma=2 $ , 
\begin{equation*}
    C(n)= \frac{n(n+1)}{2}
\end{equation*}

\begin{example}
    \begin{equation*}
        \sum_{k=0}^{n}(a+b k)
    \end{equation*}
\end{example}
\begin{solve}
    \begin{equation*}
        \left\{
            \begin{array}{l}
                R_0 = a \\
                R_n = R_{n-1} + a+bn\\
            \end{array}
        \right.
    \end{equation*}
    \begin{equation*}
        \left\{
            \begin{array}{l}
                R_0 = \alpha \\
                R_n = R_{n-1} + \beta + \gamma n\\
            \end{array}
        \right.
    \end{equation*}
    $ \alpha = \beta =a, \gamma = b $ 
    \begin{align*}
        A(n)\alpha + B(n)\beta + C(n)\gamma 
        &= a A(n) + a B(n) + b C(n)\\
        &= a + a n + b \frac{n(n+1)}{2}\\
        &= a(n+1)+\frac{bn(n+1)}{2}
    \end{align*}
\end{solve}

对上述递归情况进行推广
\begin{equation}\label{RecuHard}
    \left\{
    \begin{aligned}
        R_0 &= \alpha \\
        R_n &= R_{n-1} + \beta + \gamma n + \delta n^2, \quad n>0
    \end{aligned}
    \right.
\end{equation}
\begin{equation}\label{RecuHardABC}
    R_n = A(n)\alpha + B(n)\beta + C(n)\gamma +D(n) \delta
\end{equation}
$ \delta=0 $ 时 (\ref{RecuHard})与(\ref{ReceEasy})一致, 说明
$ A(n), B(n), C(n) $ 不变\\
$ R_n = n^3 $ 
\begin{align*}
    R_n = R_{n-1} &= n^3 - (n-1)^3 \\
    &= 3n^2 - 3n + 1
\end{align*}
解得$ \alpha=0, \beta=1, \gamma=-3, \delta=3 $ 
\begin{align*}
    n^3 &= B(n)-3C(n)+3D(n)\\
    &= n-3 \frac{n(n+1)}{2}+3D(n)
\end{align*}
\begin{align*}
    3D(n) &= n^3 - n + 3 \frac{n(n+1)}{2} \\
    &= n(n+1) \left[(n-1)+\frac{3}{2}\right] \\
    &= n(n+1)(n+\frac{1}{2})\\
    D(n) &= \frac{1}{3}\left((n+1)(n+\frac{1}{2})n\right)
\end{align*}

\subsection{求和式处理}
\subsection{多重求和}

\subsubsection{Exercise 1}
\begin{equation}
    A = \begin{bmatrix}
        a_1 a_1 & a_1 a_2 & \cdots & a_1 a_n \\
        a_2 a_1 & a_2 a_2 & \cdots & a_2 a_n \\
        \vdots  & \vdots  &        & \vdots  \\
        a_n a_1 & a_n a_2 & \cdots & a_n a_n \\
    \end{bmatrix}
\end{equation}
求 $ S_{\triangleleft} = \sum_{1\leqslant j \leqslant k \leqslant n} a_j a_k $ \footnote{下三角形矩阵的符号是一个右上部分的直角三角形, 目前我还不会输入}

\begin{solve}
    $ \because a_j a_k = a_k a_j $ , $ \therefore  $ 矩阵A沿主对角线对称, $ S_{\triangleleft} = S_{\triangleright} $ .
    \begin{equation*}
        [1\leqslant j \leqslant k \leqslant n] + [1\leqslant k \leqslant j \leqslant n] =[1\leqslant j , k \leqslant n] + [1\leqslant j = k \leqslant n]
    \end{equation*}
    \begin{align*}
        2S_{\triangleleft} &= S_{\triangleleft}+S_{\triangleright} = S_{A}+S_{diag(A)} \\
        &= \sum_{1\leqslant j , k \leqslant n} a_j a_k + \sum_{1\leqslant j = k \leqslant n} a_j a_k\\
        &= \left(\sum_{j=1}^{n} a_j\right)\left(\sum_{k=1}^{n} a_k\right) + \sum_{k=1}^{n} a_k^2\\
        &= \left(\sum_{k=1}^{n} a_k\right)^2 + \sum_{k=1}^{n} a_k^2
    \end{align*}
    $ \therefore S_{\triangleleft} = \frac{1}{2}[\left(\sum_{k=1}^{n} a_k\right)^2 + \sum_{k=1}^{n} a_k^2] $ 
\end{solve}

\subsubsection{Exercise 2}

\begin{equation}
    S = \sum_{1\leqslant j < k \leqslant n} (a_k-a_j)(b_k-b_j)
\end{equation}

\begin{solve}
    交换$ j,k $ 仍有对称性.\\
    \begin{equation*}
        S = \sum_{1\leqslant j < k \leqslant n} (a_k-a_j)(b_k-b_j)
          = \sum_{1\leqslant j < k \leqslant n} (a_j-a_k)(b_j-b_k)
    \end{equation*}
    \begin{equation*}
        [1\leqslant j < k \leqslant n] + [1\leqslant k < j \leqslant n] =[1\leqslant j , k \leqslant n] - [1\leqslant j = k \leqslant n]
    \end{equation*}
    \begin{align*}
        2S  &= 2\sum_{1\leqslant j < k \leqslant n} (a_k-a_j)(b_k-b_j)\\
            &= \sum_{1\leqslant j < k \leqslant n} (a_k-a_j)(b_k-b_j) + \sum_{1\leqslant k < j \leqslant n} (a_k-a_j)(b_k-b_j)\\
            &= \sum_{1\leqslant j , k \leqslant n} (a_k-a_j)(b_k-b_j) - \sum_{1\leqslant j = k \leqslant n} (a_k-a_j)(b_k-b_j)\\
            & (a_j-a_k=0, b_j-b_k=0, [j=k])
            &= \sum_{1\leqslant j , k \leqslant n} (a_k b_k - a_j b_k - a_k b_j + a_j b_j) \\
            &= \sum_{j=1}^{n} \sum_{k=1}^{n} a_k b_k - \sum_{j=1}^{n} \sum_{k=1}^{n} a_j b_k - \sum_{j=1}^{n} \sum_{k=1}^{n} a_k b_j + \sum_{j=1}^{n} \sum_{k=1}^{n} a_j b_j \\
            &= n\sum_{k=1}^{n} a_k b_k - \sum_{j=1}^{n} \sum_{k=1}^{n} a_j b_k - \sum_{j=1}^{n} \sum_{k=1}^{n} a_k b_j + n \sum_{j=1}^{n}  a_j b_j \\
            &= 2 n \sum_{k=1}^{n} a_k b_k - 2 \sum_{j=1}^{n} a_j  \sum_{k=1}^{n} b_k 
    \end{align*}
    \begin{equation*}
        S = n \sum_{k=1}^{n} a_k b_k - \left(\sum_{k=1}^{n} a_k \right) \left(\sum_{k=1}^{n} b_k \right)
    \end{equation*}
\end{solve}
对上式结果重新排序得
\begin{equation*}
    \left(\sum_{k=1}^{n} a_k \right) \left(\sum_{k=1}^{n} b_k \right) = n \sum_{k=1}^{n} a_k b_k - \sum_{1\leqslant j < k \leqslant n} (a_k-a_j)(b_k-b_j)
\end{equation*}

\begin{theorem}
    切比雪夫单调不等式 (Chebyshec's monotonic inequality)

\begin{equation*}
    \begin{array}{lll}
        \left(\sum_{k=1}^{n} a_k \right) \left(\sum_{k=1}^{n} b_k \right)   &\leqslant n \sum_{k=1}^{n} a_k b_k & \quad a_1\leqslant a_2\leqslant \dots\leqslant a_n, \text{and } b_1\leqslant b_2\leqslant \dots\leqslant b_n \\        
        & & \quad a_1\geqslant a_2\geqslant \dots\geqslant a_n, \text{and } b_1\geqslant b_2\geqslant \dots\geqslant b_n\\
        \left(\sum_{k=1}^{n} a_k \right) \left(\sum_{k=1}^{n} b_k \right)   &\geqslant n \sum_{k=1}^{n} a_k b_k & \quad a_1\leqslant a_2\leqslant \dots\leqslant a_n, \text{and } 
        b_1\geqslant b_2\geqslant \dots\geqslant b_n\\
        & & \quad a_1\geqslant a_2\geqslant \dots\geqslant a_n, \text{and }
        b_1\leqslant b_2\leqslant \dots\leqslant b_n \\        
    \end{array}
\end{equation*}
\end{theorem}
    一般来说，如果$ a_1 \leqslant a_2 \leqslant \dots \leqslant a_n $ 且 $ p $ 是$ \{1,\dots,n \} $ 的一个排列。\\
    那么不难证明：\\
    当$ b_{p(1)}\leqslant \dots \leqslant b_{p(n)} $ 时$ \sum_{k=1}^{n} a_k b_{P(k)} $ 最大.\\
    当$ b_{p(1)}\geqslant \dots \geqslant b_{p(n)} $ 时$ \sum_{k=1}^{n} a_k b_{P(k)} $ 最小.

    \begin{equation*}
        \sum_{k\in K} a_k = \sum_{P(k)\in K} a_{P(k)} 
    \end{equation*}
    $ P(k) $ 为这些整数的任意一个排列。
    \begin{equation*}
        f: J\Rightarrow K, \quad j\in J \quad f(j) \in K
    \end{equation*}
    \begin{equation*}
        \sum_{j\in J}a_{f(j)} = \sum_{k\in K} a_k \quad \#f^-(k)
    \end{equation*}
    式中 $ \#f^-(k) $ 表示集合$ f^-(k) = \{j | f(j)=k\} $ 中元素的个数
    \begin{equation*}
        \sum_{j\in J}[f(j)=k] = \#f^-(k)
    \end{equation*}
    \begin{equation*}
        \sum_{j\in J}a_{f(j)} = \sum_{\begin{array}{l}j\in J\\ k\in K\\ \end{array}}a_k[f(j)=k] = \sum_{k\in K}a_k \sum_{j\in J} [f(j)=k]
    \end{equation*}
    若有 $ \#f^-(k) = 1 $ (一一对应)\footnote{这里还不太理解}
    \begin{equation*}
        \sum_{j\in J} a_{f(j)} = \sum_{f(j)\in K}a_{f(j)} = \sum_{k\in K} a_k
    \end{equation*}

\subsubsection{Exercise 3}
\begin{equation*}
    S_n = \sum_{1\leqslant j < k\leqslant n}\frac{1}{k-j}
\end{equation*}
首先写出前几项，尝试寻找规律：
\begin{align*}
    S_1 &= 0\\
    S_2 &= \frac{1}{2-1} = 1\\
    S_3 &= \frac{1}{2-1}+\frac{1}{3-1}+\frac{1}{3-2} = \frac{5}{2}\\
    S_4 &= \frac{1}{2-1}+\frac{1}{3-1}+\frac{1}{4-1}+\frac{1}{3-2}+\frac{1}{4-2}+\frac{1}{4-3} = \frac{13}{3}
\end{align*}
\begin{solve}
    1. 先对$ j $ 求和
    \begin{align*}
        S_n 
        &= \sum_{1\leqslant k \leqslant n} \sum_{1\leqslant j < k}\frac{1}{k-j}\\
        &= \sum_{1\leqslant k \leqslant n} \sum_{1\leqslant (k-j) < k}\frac{1}{k-(k-j)} \quad j\Rightarrow (k-j) \\
        &= \sum_{1\leqslant k \leqslant n} \sum_{0<j\leqslant k-1}\frac{1}{j} \\
        &= \sum_{1\leqslant k \leqslant n} H_{k-1} \quad(H_k\text{为调和级数})\\
        &= \sum_{1\leqslant k+1 \leqslant n} H_{k}\quad k\Rightarrow k+1 \\
        &= \sum_{0\leqslant k < n} H_{k}
    \end{align*}
    2. 先对$ k $ 求和
    \begin{align*}
        S_n 
        &= \sum_{1\leqslant j \leqslant n} \sum_{j < k\leqslant n}\frac{1}{k-j}\\
        &= \sum_{1\leqslant j \leqslant n} \sum_{j < (k+j)\leqslant n}\frac{1}{(k+j)-j} \quad k\Rightarrow (k+j) \\
        &= \sum_{1\leqslant j \leqslant n} \sum_{0<k\leqslant n-j}\frac{1}{k} \\
        &= \sum_{1\leqslant j \leqslant n} H_{n-j} \quad(H_k\text{为调和级数})\\
        &= \sum_{1\leqslant n-j \leqslant n} H_{k}\quad j\Rightarrow n-j \\
        &= \sum_{0\leqslant j < n} H_{j}
    \end{align*}
    以上两种常用的求和顺序都无法得到这个多重求和的结果，我们需要转换思路.

    3. 先用$ k+j $ 替换$ k $ (先换元，再求和)
    \begin{align*}
        S_n 
        &= \sum_{1\leqslant j < (k+j)\leqslant n}\frac{1}{(k+j)-j} \quad k\Rightarrow k+j \\
        &= \sum_{1\leqslant j < (k+j)\leqslant n}\frac{1}{k} \\
        &= \sum_{1\leqslant k \leqslant n} \sum_{1\leqslant j \leqslant n-k}\frac{1}{k} \quad\text{首先对}j\text{求和} \\
        &= \sum_{1\leqslant k \leqslant n} \frac{n-k}{k}\\
        &= \sum_{1\leqslant k \leqslant n} \left( \frac{n}{k}-1 \right) = n H_n - n
    \end{align*}
    综上可得$ \sum_{1\leqslant k\leqslant n}H_k = n H_n - n $ 
\end{solve}
代数：
$ k+f(j) $ , $ f $ 为任意函数.\\
用$ k-f(j) $ 替换$ k $ ，并对$ j $ 先求和较好。\\
几何：
$ S_n \;(n=4) $ 
\begin{equation*}
    \begin{array}{ccccc}
            & k=1   & k=2   & k=3   & k=4   \\
        j=1 & & \frac{1}{1} & +\frac{1}{2} & +\frac{1}{3} \\
        j=2 & &             & +\frac{1}{1} & +\frac{1}{2} \\
        j=3 & &             &              & +\frac{1}{1} \\
        j=4 & &             &              &              \\
    \end{array}
\end{equation*}
先对$ j $ 求和(按列) $ H_1 + H_2 + H_3 $ 
先对$ k $ 求和(按行) $ H_3 + H_2 + H_1 $ 
$ k\Rightarrow k+j $ 按对角线求和 
% \begin{align*}
%     \frac{3}{1}+\frac{2}{2}+\frac{1}{3} &= \sum_{k=1}^{3}\frac{3-k}{k} \\ 
%     &= 3\sum_{k=1}^{3}\frac{1}{k}-\sum_{k=1}^{3} 1 \\
%     &= 3H_3 - 3
% \end{align*}
\begin{equation*}
    \sum_{k=1}^{n}\frac{n-k}{k} = n \sum_{k=1}^{n}\frac{1}{k}-\sum_{k=1}^{n} 1
\end{equation*}
$ nH_n-n $ ,$ n=4 $ 
\begin{align*}
    \frac{4}{1}+\frac{3}{2}+\frac{2}{3}+\frac{1}{4} &= \sum_{k=1}^{4}\frac{4-k}{k} \\ 
    &= 4\sum_{k=1}^{4}\frac{1}{k}-\sum_{k=1}^{4} 1 \\
    &= 4H_4 - 4
\end{align*}
\begin{equation*}
    4\left(1+\frac{1}{2}+\frac{1}{3}+\frac{1}{4}\right)-4 = \frac{4}{2}+\frac{4}{3}+\frac{4}{4}
\end{equation*}
\begin{equation*}
    \begin{array}{ccccc}
            & k-j=0   & k-j=1   & k-j=2   & k-j=3   \\
        j=1 & & \frac{1}{1} & +\frac{1}{2} & +\frac{1}{3} \\
        j=2 & & \frac{1}{1} & +\frac{1}{2} &              \\
        j=3 & & \frac{1}{1} &              &              \\
        j=4 & &             &              &              \\
    \end{array}
\end{equation*}

\subsection{General methods}
\subsubsection{Exercise 4}
求 $ \square_n = \sum_{0\leqslant k \leqslant n}k^2 $ , $ n\geqslant 0 $ 的封闭形式
\begin{align*}
    \sum_{k=0}^{n}k^2 
    &= \sum_{k=0}^{n}[(k+1)^2-2k-1] \\
    &= \sum_{k=1}^{n+1}k^2 - 2 \sum_{k=0}^{n}k - \sum_{k=0}^{n}1
\end{align*}
\begin{align*}
    0^2-(n+1)^2 &= -2 \sum_{k=0}^{n}k - (n+1) \\
    2\sum_{k=0}^{n} k &= (n+1)^2 - (n+1)\\
    \sum_{k=0}^{n} k &= \frac{(n+1)n}{2}\\
\end{align*}
上述运算没有告诉我们$ \square_n $ 的值，但却能推导出$ \sum_{k=0}^{n}k $ 的值。我们可以利用这种思路求解$ \square_n $ 。
\begin{align*}
    \sum_{k=0}^{n}\left[(k+1)^3-k^3\right] &= \sum_{k=0}^{n}\left[ 3k^2+3k+1 \right] \\
    (n+1)^3 - 0^3 &= 3 \sum_{k=0}^{n}k^2 + 3 \sum_{k=0}^{n}k +  \sum_{k=0}^{n}1 \\
    (n+1)^3 &= 3 \sum_{k=0}^{n}k^2 + 3 \frac{n(n+1)}{2} + (n+1)
\end{align*}
\begin{align*}
    3\sum_{k=0}^{n}k^2 &= (n+1)^3 - 3\frac{n(n+1)}{2}-(n+1) \\
    \sum_{k=0}^{n}k^2 &= \frac{1}{3}(n+1)\left((n+1)^2-\frac{3}{2}n-1\right)\\
    \sum_{k=0}^{n}k^2 &= \frac{1}{3}(n+1)(n+\frac{1}{2})n
\end{align*}

reference book list:\\
1. (CRC Tables) CRC Standard Mathematical Tables\\
2. Handbook of Mathematical Functions\\
3. Sloane. Handbook of Integer Sequences\\
software: \\
Axiom MACSYMA Maple Mathematica\\
my: Octave maxima
熟悉标准的信息源

方法3：建立成套方法

参考第二节的内容

方法4：用积分替换和式 $ \sum \Rightarrow \int $ 
\begin{equation*}
    \square_n = 1\times1+1\times4+1\times9 +\dots+1\times n^2
\end{equation*}
该式近似等于0到$ n $ 之间曲线$ f(x)=x^2 $ 下的面积
\begin{align*}
    S &= \int_{0}^{n}x^2 dx \\
    &=\frac{n^3}{3}
\end{align*}
$ \square_n $ 近似等于 $ \frac{n^3}{3} $ 。
近似的误差$ E_n = \square_n - \frac{n^3}{3} $ 

1. 近似误差项递归式
\begin{align*}
    \square_n &= \square_{n-1}+n^2 \\
    E_n &= \square_n - \frac{n^3}{3} = \square_{n-1} + n^2 - \frac{n^3}{3} \\
    E_{n-1} &= \square_{n-1} - \frac{(n-1)^3}{3}\\
    E_n &= E_{n-1} + \frac{(n-1)^3}{3} + n^2 - \frac{n^3}{3} \\
        &= E_{n-1} + \frac{-3n^2+3n-1}{3} + n^2 \\
        &= E_{n-1} + n - \frac{1}{3}
\end{align*}

2. 对楔形误差项面积求和
\begin{align*}
    \square_n - \int_{0}^{n}x^2 dx 
    &= \sum_{k=1}^{n}\left( k^2 - \int_{k-1}^{k}x^2 dx \right) \\
    &= \sum_{k=1}^{n}\left( k^2 - \frac{k^3-(k-1)^3}{3} \right) \\
    &= \sum_{k=1}^{n}\left( k - \frac{1}{3} \right)
\end{align*}
\begin{equation*}
    E_n = \sum_{k=1}^{n}\left( k - \frac{1}{3} \right) = \frac{n(n+1)}{2}-\frac{n}{3} = \frac{n(3n+1)}{6}
\end{equation*}
\begin{align*}
    \square_n &= \frac{n^3}{3}+E_n \\
    &= \frac{n^3}{3}+\frac{n(3n+1)}{6} \\
    &= \frac{n(2n^2+3n-1)}{6} \\
    &= \frac{n(n+\frac{1}{2})(n+1)}{3}
\end{align*}

方法5：展开和收缩
\begin{align*}
    \square_n
    &= \sum_{1\leqslant k \leqslant n} k^2 = \sum_{1\leqslant j\leqslant k \leqslant n} k\\
    &= \sum_{1\leqslant j\leqslant n} \sum_{j\leqslant k\leqslant n} k \\
    &= \sum_{1\leqslant j\leqslant n} \left(\frac{(j+n)(n-j+1)}{2}\right) \\
    &= \frac{1}{2} \sum_{1\leqslant j\leqslant n} (n(n+1)+j-j^2) \\
    &= \frac{1}{2} \left[n^2(n+1) + \frac{n(n+1)}{2} - \square_n \right]\\
    &= \frac{1}{2} n(n+\frac{1}{2})(n+1)-\frac{1}{2}\square_n
\end{align*}
\begin{align*}
    \frac{3}{2}\square_n &= \frac{1}{2} n(n+\frac{1}{2})(n+1) \\
    \square_n &= \frac{1}{3} n(n+\frac{1}{2})(n+1) \\
\end{align*}

方法6：使用有限微积分

方法7：用生成函数

\subsection{有限微积分和无限微积分 Finite and infinite calculus}
\begin{table}[htbp]
	\centering
	\small
	\caption{有限微积分和无限微积分中的运算对比}
	\begin{tabular}{l|l}
		\toprule
        无限微积分 & 有限微积分 \\
		\midrule
        微分算子D & 差分算子$ \Delta $ \\
		\bottomrule
	\end{tabular}%
	\label{tab:ContiAndDis001}%
\end{table}%

\begin{equation*}
    \begin{array}{ll}
        Df(x) = \lim_{h \to 0}\frac{f(x+h)-f(x)}{h}  &  \Delta f(x) = f(x+1)-f(x) \\
        D(x^m)=mx^{m-1} & \Delta (x^3) = 3x^2+3x+1\\
    \end{array}
\end{equation*}

为使差分运算在形式上与微分运算类似，引入下降阶乘幂和上升阶乘幂。\\
下降阶乘幂 (failing factorial power), $ x\fallingfactorial{m} $ , 读作$ x $ 直降$ m $ 次.\\
\begin{equation*}
    x\fallingfactorial{m} = \underbrace{x(x-1)\dots(x-m+1)}_{\textit{m个因子}}, \quad (m\leqslant 0, m\in\mathbb{N}) 
\end{equation*}
上升阶乘幂 (rising factorial power), $ x\risingfactorial{m} $ , 读作$ x $ 直升$ m $ 次.\\
\begin{equation*}
    x\risingfactorial{m} = \underbrace{x(x+1)\dots(x+m-1)}_{\textit{m个因子}}, \quad (m\leqslant 0, m\in\mathbb{N}) 
\end{equation*}
\begin{align*}
    \Delta(x\fallingfactorial{m}) &= (x+1)\fallingfactorial{m}-x\fallingfactorial{m} \\
    &= (x+1)x\dots(x+1-m+1) - x(x-1)\dots(x-m+1) \\
    &= (x+1-(x-m+1))x(x-1)\dots(x-m+2) \\
    &= mx(x-1)\dots(x-m+2) \\
    &= mx\fallingfactorial{m-1}
\end{align*}

\begin{table}[htbp]
	\centering
	\small
	\caption{有限微积分和无限微积分中的运算对比}
	\begin{tabular}{l|l}
		\toprule
        无限微积分 & 有限微积分 \\
		\midrule
        D逆运算$ \int $ (积分算子，逆微分算子) & $ \Delta $逆运算 $ \sum $ (求和算子，逆差分算子) \\
        微积分基本定理 & \\
        $ g(x)=Df(x)\iff\int g(x)dx=f(x)+C $ & $ g(x)=\Delta f(x)\iff\sum g(x)\delta(x)=f(x)+C $ \\
        定积分 & 和式 \\
        若$ g(x)=Df(x) $ 那么 & 若$ g(x)=\Delta f(x) $ 那么 \\ 
        $ \int_{a}^{b}g(x)dx=f(x)|_{a}^b=f(b)-f(a) $ & 
        $ \sum_{a}^{b}g(x)\delta x=f(x)|_{a}^b=f(b)-f(a) $ \\
        $ \int_{b}^{a}g(x)dx = -\int_{a}^{b}g(x)dx $  &
        $ \sum_{b}^{a}g(x)\delta x = -\sum_{a}^{b}g(x)\delta x $ \\
        $ \int_{a}^{b}+\int_{b}^{c}=\int_{a}^{c} $ &
        $ \sum_{a}^{b}+\sum_{b}^{c}=\sum_{a}^{c} $ \\
        & \\
        $ \int_{0}^{n}x^m=\cfrac{x^{m+1}}{m+1}\Big|_0^n=\cfrac{n^{m+1}}{m+1} $, $ m\neq -1 $  &
        $ \sum_{0}^{n}k\fallingfactorial{m} = \cfrac{k\fallingfactorial{m+1}}{m+1}\Big|_0^n =\cfrac{n\fallingfactorial{m+1}}{m+1} $,$ m\neq-1 $ \\ 
        & $ \sum_{0}^{n}k\risingfactorial{m} = \cfrac{k\risingfactorial{m+1}}{m+1}\Big|_0^n =\cfrac{n\risingfactorial{m+1}}{m+1} $,$ m\neq-1 $ \\ 
        & \\
        $ (x+y)^2=x^2+2xy+y^2  $ 
        & $ (x+y)\fallingfactorial{2}=x\fallingfactorial{2}+2x\fallingfactorial{2}y\fallingfactorial{1}+y\fallingfactorial{2} $ \\
        & $ (x+y)\risingfactorial{2}=x\risingfactorial{2}+2x\risingfactorial{1}y\risingfactorial{1}+y\risingfactorial{2} $ \\
        & \\
        {\color{red}$ m=-1,\int_{a}^{b}x^{-1}=\ln{x}\Big|_a^b $ } &
        {\color{red}$ m=-1,\sum_{a}^{b}k\fallingfactorial{-1}=H_{k}\Big|_a^b $ }\\
        $ \int_{a}^{b}x^m=\begin{array}{l}
            \cfrac{x^{m+1}}{m+1}\Big|_a^b, \; m\neq -1 \\
            \ln{n}\Big|_a^b, \; m= -1 \\
        \end{array} $ &
        $ \sum_a^b k\fallingfactorial{m} = \begin{array}{l}
            \cfrac{k\fallingfactorial{m+1}}{m+1}\Big|_a^b,\; m\neq-1 \\
            H_k\Big|_a^b,\; m=-1 \\
        \end{array}$ \\ 
        & $ \sum_a^b k\risingfactorial{m} = \begin{array}{l}
            \cfrac{k\risingfactorial{m+1}}{m+1}\Big|_a^b ,\;m\neq-1\\
            H_{(k+1)}\Big|_a^b ,\;m\neq-1 \\ % {\color{red}(??)}\\
        \end{array} $ \\ 
        连续性问题的解中会出现自然对数 & 快速排序这样的问题中会出现调和数的原因 \\
        & \\
        $ e^{x} $, 性质 $ De^x = e^x $  & $ \Delta f(x)=f(x), f(x)=2^x $ 离散指数函数 \\
		\bottomrule
	\end{tabular}%
	\label{tab:ContiAndDis002}%
\end{table}%

\begin{equation}
    g(x)=Df(x),\iff \underbrace{\int g(x)dx}_{\textit{不定积分}} = f(x)+\underbrace{C}_{\textit{任意常数}}
\end{equation} 

\begin{equation}
    g(x)=\Delta f(x),\iff \underbrace{\sum g(x)\delta(x)}_{\textit{不定和式}} = f(x)+\underbrace{C}_{\textit{满足}p(x+1)=p(x)\textit{的任意函数}} 
\end{equation}

\begin{equation}
    \sum_{a}^{b}g(x)\delta x=f(x)|_{a}^b=f(b)-f(a) 
\end{equation}
设 $ g(x)=\Delta f(x)=f(x+1)-f(x) $ \\
如果$ b=a $ , 我们就有
\begin{equation}
    \sum_{a}^{a}g(x) \delta x = f(a)-f(a) = 0
\end{equation}
如果$ b=a+1 $ , 我们就有
\begin{equation}
    \sum_{a}^{a+1}g(x) \delta x = f(a+1)-f(a) = g(a)
\end{equation}

\begin{align*}
    \sum_{a}^{b+1}g(x) \delta x - \sum_{a}^{b}g(x) \delta x 
    &= \bigl[f(b+1)-f(a)\bigr] - \bigl[f(b)-f(a)\bigr] \\
    &= f(b+1)-f(b) = g(b)
\end{align*}
由数学归纳法$ a, b \in\mathbb{N} $ 且$ b\leqslant a $ 时，$ \sum_{a}^{b}g(x)\delta x $ 的确切含义是
\begin{equation}
    \sum_{a}^{b}g(x) \delta x = \sum_{k=1}^{b-1}g(k) = \sum_{a\leqslant k < b}g(k),\quad (b\geqslant a, a,b\in \mathbb{N})
\end{equation}
若有$ g(x)=f(x+1)-f(x) $ 
\begin{equation*}
    \sum_{a\leqslant k <b}g(l) = \sum_{a\leqslant k<b}(f(k+1)-f(k))=f(b)-f(a)
\end{equation*}

\begin{align*}
    \sum_{a}^{b}g(x)\delta x &= f(b)-f(a)\qquad (b<a) \\
    &= -(f(a)-f(b)) = -\sum_{a}^{b}g(x)\delta x
\end{align*}
\begin{equation*}
    \sum_{a}^{b}+\sum_{b}^{c} = \sum_{a}^{c}
\end{equation*}
应用：计算下降幂和式的简单方法
\begin{equation}
    \sum_{0\leqslant k<n}k\fallingfactorial{m} = \frac{k\fallingfactorial{m+1}}{m+1}\Big|_0^n = \frac{n\fallingfactorial{m+1}}{m+1},\quad \left(m,n\geqslant 0\quad m,n\in\mathbb{N}^+\right)
\end{equation}
$ m=1 $ 时，$ k\fallingfactorial{1}=k $ 
\begin{equation*}
    \sum_{0\leqslant k<n}k = \frac{n\fallingfactorial{2}}{2}=\frac{n(n-1)}{2}
\end{equation*}

$ k^2 = k(k-1)+k=k\fallingfactorial{2}+k\fallingfactorial{1} $ 
\begin{align*}
    \sum_{0\leqslant k<n} k^2
    % \sum_{0\leqslant k<n}
    % k\fallingfactorial{2}+
    % \sum_{0\leqslant k<n}
    % k\fallingfactorial{1} 
    &=\frac{n\fallingfactorial{3}}{3} + \frac{n\fallingfactorial{2}}{2} \\
    &=\frac{n(n-1)(n-2)}{3}+\frac{n(n-1)}{2} \\
    &=\frac{1}{3}n(n-\frac{1}{2})(n-1)
\end{align*}

$ k^3 = k(k-1)(k-2) +3k(k-1) +k=k\fallingfactorial{3}+3k\fallingfactorial{2}+k\fallingfactorial{1} $ 
\begin{align*}
    \sum_{0\leqslant k<n} k^3
    &=\frac{n\fallingfactorial{4}}{4}
    +3\frac{n\fallingfactorial{3}}{3}
    + \frac{n\fallingfactorial{2}}{2}\\
    &=\frac{n(n-1)(n-2)(n-3)}{4}+3\frac{n(n-1)(n-2)}{3}+\frac{n(n-1)}{2}\\
    &=\left(\frac{1}{2}n(n-1)\right)^2 = \left(\sum_{0\leqslant k<n} k\right)^2
\end{align*}

负指数下降幂
\begin{align*}
    x\fallingfactorial{3}  &= x(x-1)(x-2) \\
    x\fallingfactorial{2}  &= x(x-1) \\
    x\fallingfactorial{1}  &= x \\
    x\fallingfactorial{0}  &= 1 \\
    x\fallingfactorial{-1} &= \frac{1}{x+1} \\
    x\fallingfactorial{-2} &= \frac{1}{(x+1)(x+2)} \\
    &\vdots \\
    x\fallingfactorial{-m} &= \frac{1}{(x+1)(x+2)\dots(x+m)} \\
\end{align*}
\begin{equation*}
    x\fallingfactorial{3}\cdot \frac{1}{x-3+1} = x\fallingfactorial{2} \Rightarrow 
    x\fallingfactorial{0}\cdot \frac{1}{x-0+1} = x\fallingfactorial{-1}
\end{equation*}
为什么选用$ x\fallingfactorial{-1}=\frac{1}{x+1} $ 
而不是 $ x\fallingfactorial{-1}=\frac{1}{x+1} $ 作为下降阶乘幂的拓展定义?\footnote{当一个原有的记号被拓展包含更多种情形时，以一
种使得一般性法则继续成立的方式来表述它的定
义，这永远是最佳选择}

通常幂法则$ x^{m+n}=x^m x^n $, 
推广:\\
{\color{red}$ x\fallingfactorial{m+n} = x\fallingfactorial{m}(x-m)\fallingfactorial{n},\;(m,n\in\mathbb{N}^+) $ }\\
{\color{red}$ x\risingfactorial{m+n} = x\risingfactorial{m}(x+m)\risingfactorial{n},\;(m,n\in\mathbb{N}^+) $ }

{my}推广至正指数下降幂
\begin{align*}
    x\risingfactorial{3}  &= x(x+1)(x+2) \\
    x\risingfactorial{2}  &= x(x+1) \\
    x\risingfactorial{1}  &= x \\
    x\risingfactorial{0}  &= 1 \\
    x\risingfactorial{-1} &= \frac{1}{x-1} \\
    x\risingfactorial{-2} &= \frac{1}{(x-1)(x-2)} \\
    &\vdots \\
    x\risingfactorial{-m} &= \frac{1}{(x-1)(x-2)\dots(x-m)} \\
\end{align*}
\begin{equation*}
    x\risingfactorial{3}\cdot \frac{1}{x+3} = x\risingfactorial{2} \Rightarrow 
    x\risingfactorial{0}\cdot \frac{1}{x+0-1} = x\risingfactorial{-1}
\end{equation*}


例如
\begin{align*}
    x\fallingfactorial{2+3} 
    &= x\fallingfactorial{2}(x-2)\fallingfactorial{3}
    =x\fallingfactorial{3}(x-3)\fallingfactorial{2} \\
    x\fallingfactorial{2-3}
    &= x\fallingfactorial{2}(x-2)\fallingfactorial{-3}\\
    &= x(x-1)\frac{1}{(x-2+1)(x-2+2)(x-2+3)}\\
    &= x(x-1)\frac{1}{(x-1)x(x+1)}\\
    &= \frac{1}{x+1}
\end{align*}

$ m<0 $ 时，$ \Delta x\fallingfactorial{m} = m x\fallingfactorial{m-1} $ 是否仍成立?
\begin{align*}
    \Delta x\fallingfactorial{-2} 
    &= \frac{1}{(x+2)(x+3)} - \frac{1}{(x+1)(x+2)} \\
    &= \frac{(x+1)-(x+3)}{(x+1)(x+2)(x+3)} \\
    &= -2x\fallingfactorial{-3}
\end{align*}
通常幂法则对负指数下降阶乘幂仍然成立。

离散指数函数 $ 2^x $ 
\begin{align*}
    \Delta (c^x) &= c^{x+1}-c^x = (c-1)c^x \\
    c \neq 1 & \frac{c^x}{c-1}\xRightarrow{\Delta}c^x\\
    \sum_{a\leqslant k <b}c^k &= \sum_{a}^{b}c^x \delta x = \frac{c^x}{c-1}\Big|_a^b =\frac{c^b-c^a}{c-1}, \; c\neq 1
\end{align*}

\begin{table}[htbp]
	\centering
	\small
	\caption{Table 55(1994), What's difference}
	\begin{tabular}{l|l}
		\toprule
        $ f=\sum g $ & $ \Delta f= g $ \\
		\midrule
        $ x\fallingfactorial{0}=1 $ & $ 0 $ \\
        $ x\fallingfactorial{1}=x $ & $ 1 $ \\
        $ x\fallingfactorial{2}=x(x-1) $ & $ 2x $ \\
        $ x\fallingfactorial{m}   $ & $ m x\fallingfactorial{m-1} $ \\
        $ x\fallingfactorial{m+1} $ & $ (m+1) x\fallingfactorial{m} $ \\
        $ H_x $ & $ x\fallingfactorial{-1}=\frac{1}{x+1} $ \\
        $ 2^x $ & $ 2^x $ \\
        $ c^x $ & $ (c-1) c^x $ \\
        $ \frac{c^x}{c-1} $ & $  c^x $ \\
        $ cu(x) $, $ c $ is constant  & $ c\Delta u(x) $ \\
        $ u+v $ & $ \Delta u+\Delta v $ \\
        $ uv $ & $ u\Delta v+Ev \Delta u $, $ Ev=v(x+1) $  \\
		\bottomrule
	\end{tabular}%
	\label{tab:55rightside}%
\end{table}%
\begin{equation}
    D(uv)=uDv+vDu
\end{equation}
\begin{equation}
    \int uDv = uv - \int vDu
\end{equation}

\begin{equation}
    \begin{array}{rl}
        \Delta (u(x)v(x))
        &=u(x+1)v(x+1)-u(x)v(x)\\
        &=u(x+1)v(x+1)-u(x)v(x+1)+u(x)v(x+1) -u(x)v(x)\\
        &=\Delta u(x)v(x+1)+u(x)\Delta v(x)\\
        &=u\Delta v+Ev \Delta u\\
    \end{array}
\end{equation}
其中$ E $ 被称为移位算子.\\
在无限微积分中，令$ x+1 \rightarrow x $ 无限细分，避开了$ E $ 
\begin{equation}
    \sum u\Delta v = uv - \sum Ev \Delta u
\end{equation} 

\begin{example}
    $ \int x e^x dx \xrightarrow[]{\text{离散模拟}} \sum x 2^x \delta x \qquad(\sum_{k=0}^{n}k2^k) $ 
\end{example}
\begin{solve}
    令$ u(x)=x, \delta v(x)=2^x $,\\
    可得$ \delta u(x)=1, v(x)=2^x,Ev = 2^{x+1} $  
    \begin{align*}
        \sum x2^x\delta x
        &= x\cdot 2^x - \sum 2^{x+1}\cdot 1\delta x\\
        &= x\cdot 2^x - 2^{x+1}+C
    \end{align*}
    \begin{align*}
        \sum_{0}^{n} k2^k
        &= \sum_{0}^{n+1}x2x\delta x\\
        &= x\cdot 2^x-2^{x+1}\Big|_0^{n+1}
    \end{align*}
    关于第二组等式的推导，我一开始没有完全掌握，主要是对求和符号$ \sum $ 的上下标范围存在误解.\\
    记$ \sum_{0\leqslant k\leqslant n} k 2^k = S_n $ 
    \begin{align*}
        \sum_{0\leqslant k\leqslant n} k 2^k + (n+1)2^{n+1}
        &= \sum_{0\leqslant k\leqslant n+1} k 2^k \\
        &= \sum_{1\leqslant k\leqslant n+1} (k-1) 2^k + \sum_{1\leqslant k\leqslant n+1} 2^k \\
        &= \sum_{0\leqslant k\leqslant n} k 2^{k+1} + \sum_{1\leqslant k\leqslant n+1} 2^k \\
        &= 2S_n + \sum_{1\leqslant k\leqslant n+1} 2^k 
    \end{align*}
    \begin{align*}
        S_n + (n+1)2^{n+1}
        &= 2S_n + \frac{2^{n+1}-2^1}{2-1}\\
        S_n &= (n+1)2^{n+1} - (2^{n+1}-2)\\
        &=(n-1)2^{n+1}+2
    \end{align*}
\end{solve}

\begin{equation}
    \sum_{0\leqslant k< n}=nH_n-n
\end{equation}

\end{document}